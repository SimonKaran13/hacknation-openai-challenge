<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tasks</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div class="container">
      <h1>Tasks</h1>
      <form method="get" action="/tasks" class="filters">
        <select name="assignee_id">
          <option value="">All assignees</option>
          {% for e in employees %}
          <option value="{{ e.id }}" {% if selected_assignee == e.id %}selected{% endif %}>
            {{ e.full_name }}
          </option>
          {% endfor %}
        </select>
        <select name="status">
          <option value="">All status</option>
          {% for s in ["todo","in_progress","blocked","done"] %}
          <option value="{{ s }}" {% if selected_status == s %}selected{% endif %}>{{ s }}</option>
          {% endfor %}
        </select>
        <select name="priority">
          <option value="">All priority</option>
          {% for p in ["low","medium","high","urgent"] %}
          <option value="{{ p }}" {% if selected_priority == p %}selected{% endif %}>{{ p }}</option>
          {% endfor %}
        </select>
        <button type="submit">Filter</button>
      </form>

      <table>
        <thead>
          <tr>
            <th>Title</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Assignee</th>
            <th>Reporter</th>
            <th>Due</th>
          </tr>
        </thead>
        <tbody>
          {% for t in tasks %}
          <tr>
            <td>{{ t.title }}</td>
            <td>{{ t.status }}</td>
            <td>{{ t.priority }}</td>
            <td>{{ t.assignee.full_name if t.assignee else "Unassigned" }}</td>
            <td>{{ t.reporter.full_name }}</td>
            <td>{{ t.due_date.strftime('%Y-%m-%d') if t.due_date else "-" }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
